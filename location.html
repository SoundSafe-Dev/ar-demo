<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>AR Demo – Current Location</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- A-Frame core -->
  <script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
  <!-- AR.js w/ GPS -->
  <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
  <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-gps-camera.min.js"></script>
  <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-gps-entity-place.min.js"></script>

  <style>
    body, html { margin:0; padding:0; width:100%; height:100%; overflow:hidden; }
    a-scene { position:fixed; top:0; left:0; width:100%; height:100%; }
  </style>
</head>
<body>
  <a-scene embedded arjs="sourceType: webcam; debugUIEnabled: false;">
    <a-assets>
      <!-- Preload the coffee model -->
      <a-asset-item id="coffeeModel" src="models/starbucks_coffee.glb"></a-asset-item>
    </a-assets>

    <!-- GPS camera -->
    <a-entity gps-camera rotation-reader></a-entity>
  </a-scene>

  <script>
    window.addEventListener('load', () => {
      if (!navigator.geolocation) {
        alert('Geolocation not supported by your browser.');
        return;
      }
      navigator.geolocation.getCurrentPosition(({ coords }) => {
        console.log('Got geolocation:', coords);
        const scene = document.querySelector('a-scene');
        scene.addEventListener('loaded', () => {
          const entity = document.createElement('a-entity');
          entity.setAttribute('gltf-model', '#coffeeModel');
          entity.setAttribute('gps-entity-place',
            `latitude: ${coords.latitude}; longitude: ${coords.longitude}`);
          entity.setAttribute('scale', '0.1 0.1 0.1');
          scene.appendChild(entity);
        });
      }, err => {
        alert('Location access denied—cannot place AR object.');
        console.error('Geolocation error:', err);
      }, { enableHighAccuracy: true, timeout: 10000 });
    });
  </script>
</body>
</html>
